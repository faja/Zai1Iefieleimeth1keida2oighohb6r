{
   "__inputs": [ ],
   "__requires": [ ],
   "annotations": {
      "list": [ ]
   },
   "editable": true,
   "gnetId": null,
   "graphTooltip": 0,
   "hideControls": false,
   "id": null,
   "links": [ ],
   "panels": [
      {
         "datasource": {
            "type": "prometheus",
            "uid": "${PROMETHEUS_DS}"
         },
         "description": "blabla",
         "fieldConfig": { },
         "gridPos": {
            "h": 5,
            "w": 3,
            "x": 0,
            "y": 0
         },
         "id": 2,
         "options": {
            "colorMode": "none",
            "graphMode": "none",
            "reduceOptions": {
               "calcs": [
                  "lastNotNull"
               ]
            },
            "textMode": "name"
         },
         "targets": [
            {
               "expr": "prometheus_build_info{job=\"$job\"}",
               "instant": true,
               "legendFormat": "{{ version }}"
            }
         ],
         "title": "Version",
         "type": "stat"
      },
      {
         "datasource": "$PROMETHEUS_DS",
         "fieldConfig": {
            "defaults": {
               "links": [ ],
               "mappings": [ ],
               "thresholds": {
                  "mode": "absolute",
                  "steps": [ ]
               },
               "unit": "none"
            }
         },
         "gridPos": {
            "h": 4,
            "w": 3,
            "x": 0,
            "y": 5
         },
         "id": 3,
         "links": [ ],
         "options": {
            "colorMode": "none",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
               "calcs": [
                  "lastNotNull"
               ],
               "fields": "",
               "values": false
            },
            "textMode": "name"
         },
         "pluginVersion": "7",
         "targets": [
            {
               "expr": "prometheus_build_info{job=\"${job}\"}",
               "format": "time_series",
               "instant": true,
               "intervalFactor": 2,
               "legendFormat": "{{ goversion }}",
               "refId": "A"
            }
         ],
         "title": "Go version",
         "transparent": false,
         "type": "stat"
      },
      {
         "content": "<img \nwidth=\"100%\"\nheight=\"100%\"\nsrc=\"https://public.amsdard.io/kapitan_bomba/003.jpg\">\n</img>",
         "datasource": null,
         "gridPos": {
            "h": 5,
            "w": 3,
            "x": 3,
            "y": 0
         },
         "id": 4,
         "mode": "html",
         "title": "",
         "transparent": true,
         "type": "text"
      },
      {
         "datasource": "$PROMETHEUS_DS",
         "fieldConfig": {
            "defaults": {
               "links": [ ],
               "mappings": [ ],
               "thresholds": {
                  "mode": "absolute",
                  "steps": [ ]
               },
               "unit": "s"
            }
         },
         "gridPos": {
            "h": 4,
            "w": 3,
            "x": 3,
            "y": 5
         },
         "id": 5,
         "links": [ ],
         "options": {
            "colorMode": "none",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
               "calcs": [
                  "lastNotNull"
               ],
               "fields": "",
               "values": false
            },
            "textMode": "auto"
         },
         "pluginVersion": "7",
         "targets": [
            {
               "expr": "time() - process_start_time_seconds{job=\"${job}\"}",
               "format": "time_series",
               "instant": true,
               "intervalFactor": 2,
               "legendFormat": "",
               "refId": "A"
            }
         ],
         "title": "Uptime",
         "transparent": false,
         "type": "stat"
      },
      {
         "datasource": {
            "type": "prometheus",
            "uid": "${PROMETHEUS_DS}"
         },
         "fieldConfig": {
            "defaults": {
               "color": {
                  "fixedColor": "#6262ce",
                  "mode": "fixed"
               },
               "custom": {
                  "fillOpacity": 6
               },
               "min": 0
            }
         },
         "gridPos": {
            "h": 9,
            "w": 6,
            "x": 6,
            "y": 0
         },
         "id": 6,
         "options": {
            "legend": {
               "displayMode": "hidden"
            }
         },
         "targets": [
            {
               "expr": "rate(prometheus_target_interval_length_seconds_count{job=\"$job\"}[$__rate_interval]) * 60",
               "legendFormat": "scrapes/min"
            }
         ],
         "title": "Scrapes / minute",
         "type": "timeseries"
      },
      {
         "datasource": {
            "type": "prometheus",
            "uid": "${PROMETHEUS_DS}"
         },
         "fieldConfig": {
            "defaults": {
               "color": {
                  "fixedColor": "#880749",
                  "mode": "fixed"
               },
               "custom": {
                  "fillOpacity": 6
               },
               "min": 0,
               "unit": "short"
            }
         },
         "gridPos": {
            "h": 5,
            "w": 6,
            "x": 12,
            "y": 0
         },
         "id": 7,
         "options": {
            "legend": {
               "displayMode": "hidden"
            }
         },
         "targets": [
            {
               "expr": "prometheus_tsdb_head_series{job=\"$job\"}",
               "legendFormat": "time series"
            }
         ],
         "title": "Time series",
         "type": "timeseries"
      },
      {
         "datasource": {
            "type": "prometheus",
            "uid": "${PROMETHEUS_DS}"
         },
         "fieldConfig": {
            "defaults": {
               "color": {
                  "fixedColor": "#880749",
                  "mode": "fixed"
               },
               "custom": {
                  "fillOpacity": 6
               },
               "min": 0,
               "unit": "short"
            }
         },
         "gridPos": {
            "h": 4,
            "w": 6,
            "x": 12,
            "y": 5
         },
         "id": 8,
         "options": {
            "legend": {
               "displayMode": "hidden"
            }
         },
         "targets": [
            {
               "expr": "rate(prometheus_tsdb_head_samples_appended_total{job=\"$job\"}[$__rate_interval])",
               "legendFormat": "appends/s"
            }
         ],
         "title": "Samples appended / s",
         "type": "timeseries"
      },
      {
         "datasource": {
            "type": "prometheus",
            "uid": "${PROMETHEUS_DS}"
         },
         "fieldConfig": {
            "defaults": {
               "color": {
                  "fixedColor": "light-red",
                  "mode": "fixed"
               },
               "unit": "bytes"
            }
         },
         "gridPos": {
            "h": 5,
            "w": 3,
            "x": 18,
            "y": 0
         },
         "id": 9,
         "options": {
            "colorMode": "none",
            "reduceOptions": {
               "calcs": [
                  "lastNotNull"
               ]
            }
         },
         "targets": [
            {
               "expr": "prometheus_tsdb_storage_blocks_bytes{job=\"$job\"}"
            }
         ],
         "title": "Storage size",
         "type": "stat"
      },
      {
         "datasource": "$PROMETHEUS_DS",
         "description": "Number of configured uniq jobs.",
         "fieldConfig": {
            "defaults": {
               "links": [ ],
               "mappings": [ ],
               "thresholds": {
                  "mode": "absolute",
                  "steps": [ ]
               },
               "unit": "none"
            }
         },
         "gridPos": {
            "h": 4,
            "w": 3,
            "x": 18,
            "y": 5
         },
         "id": 10,
         "links": [ ],
         "options": {
            "colorMode": "none",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
               "calcs": [
                  "lastNotNull"
               ],
               "fields": "",
               "values": false
            },
            "textMode": "auto"
         },
         "pluginVersion": "7",
         "targets": [
            {
               "expr": "count(prometheus_sd_discovered_targets{job=\"$job\"})",
               "format": "time_series",
               "instant": true,
               "intervalFactor": 2,
               "legendFormat": "",
               "refId": "A"
            }
         ],
         "title": "Jobs",
         "transparent": false,
         "type": "stat"
      },
      {
         "datasource": {
            "type": "prometheus",
            "uid": "${PROMETHEUS_DS}"
         },
         "description": "blabla...",
         "fieldConfig": {
            "defaults": {
               "unit": "s"
            }
         },
         "gridPos": {
            "h": 5,
            "w": 3,
            "x": 21,
            "y": 0
         },
         "id": 11,
         "options": {
            "colorMode": "none",
            "graphMode": "none",
            "reduceOptions": {
               "calcs": [
                  "lastNotNull"
               ]
            }
         },
         "targets": [
            {
               "expr": "time() - prometheus_tsdb_lowest_timestamp_seconds{job=\"$job\"}",
               "instant": true
            }
         ],
         "title": "Retention",
         "type": "stat"
      },
      {
         "datasource": "$PROMETHEUS_DS",
         "description": "In K8S this value is actually number of discovered targets, not scraped, so the value is bullshit.",
         "fieldConfig": {
            "defaults": {
               "links": [ ],
               "mappings": [ ],
               "thresholds": {
                  "mode": "absolute",
                  "steps": [ ]
               },
               "unit": "none"
            }
         },
         "gridPos": {
            "h": 4,
            "w": 3,
            "x": 21,
            "y": 5
         },
         "id": 12,
         "links": [ ],
         "options": {
            "colorMode": "none",
            "graphMode": "none",
            "justifyMode": "auto",
            "orientation": "auto",
            "reduceOptions": {
               "calcs": [
                  "lastNotNull"
               ],
               "fields": "",
               "values": false
            },
            "textMode": "auto"
         },
         "pluginVersion": "7",
         "targets": [
            {
               "expr": "sum(prometheus_sd_discovered_targets{job=\"$job\"})",
               "format": "time_series",
               "instant": true,
               "intervalFactor": 2,
               "legendFormat": "",
               "refId": "A"
            }
         ],
         "title": "Targets",
         "transparent": false,
         "type": "stat"
      },
      {
         "collapse": true,
         "collapsed": true,
         "gridPos": {
            "X": 0,
            "h": 1,
            "w": 24,
            "y": 9
         },
         "id": 13,
         "panels": [
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "light-red",
                        "mode": "fixed"
                     },
                     "custom": {
                        "fillOpacity": 6
                     },
                     "unit": "bytes"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 0,
                  "y": 10
               },
               "id": 14,
               "options": {
                  "legend": {
                     "displayMode": "hidden"
                  }
               },
               "targets": [
                  {
                     "expr": "prometheus_tsdb_storage_blocks_bytes{job=\"$job\"}",
                     "legendFormat": "storage size"
                  }
               ],
               "title": "Storage size",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "super-light-red",
                        "mode": "fixed"
                     },
                     "custom": {
                        "fillOpacity": 6
                     }
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 8,
                  "y": 10
               },
               "id": 15,
               "options": {
                  "legend": {
                     "displayMode": "hidden"
                  }
               },
               "targets": [
                  {
                     "expr": "rate(prometheus_tsdb_head_samples_appended_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "appends/s"
                  }
               ],
               "title": "Samples appended / s",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "#e2c5c5",
                        "mode": "fixed"
                     },
                     "custom": {
                        "fillOpacity": 6
                     }
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 16,
                  "y": 10
               },
               "id": 16,
               "options": {
                  "legend": {
                     "displayMode": "hidden"
                  }
               },
               "targets": [
                  {
                     "expr": "prometheus_tsdb_blocks_loaded{job=\"$job\"}",
                     "legendFormat": "blocks"
                  }
               ],
               "title": "Blocks loaded",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "light-blue",
                        "mode": "fixed"
                     },
                     "custom": {
                        "fillOpacity": 20
                     },
                     "min": 0,
                     "unit": "short"
                  },
                  "overrides": [
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "series created"
                        },
                        "properties": [
                           {
                              "id": "custom.axisPlacement",
                              "value": "right"
                           },
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "dark-green",
                                 "mode": "fixed"
                              }
                           },
                           {
                              "id": "custom.drawStyle",
                              "value": "bars"
                           },
                           {
                              "id": "custom.lineWidth",
                              "value": 2
                           }
                        ]
                     },
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "series removed"
                        },
                        "properties": [
                           {
                              "id": "custom.axisPlacement",
                              "value": "right"
                           },
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "dark-red",
                                 "mode": "fixed"
                              }
                           },
                           {
                              "id": "custom.drawStyle",
                              "value": "bars"
                           },
                           {
                              "id": "custom.lineWidth",
                              "value": 2
                           }
                        ]
                     }
                  ]
               },
               "gridPos": {
                  "h": 8,
                  "w": 12,
                  "x": 0,
                  "y": 18
               },
               "id": 17,
               "options": { },
               "targets": [
                  {
                     "expr": "increase(prometheus_tsdb_head_series_created_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "series created"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_head_series_removed_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "series removed"
                  },
                  {
                     "expr": "prometheus_tsdb_head_series{job=\"$job\"}",
                     "legendFormat": "series total"
                  }
               ],
               "title": "Series (head block)",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "light-blue",
                        "mode": "fixed"
                     },
                     "custom": {
                        "fillOpacity": 20
                     },
                     "min": 0,
                     "unit": "short"
                  },
                  "overrides": [
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "chunks created"
                        },
                        "properties": [
                           {
                              "id": "custom.axisPlacement",
                              "value": "right"
                           },
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "dark-green",
                                 "mode": "fixed"
                              }
                           },
                           {
                              "id": "custom.drawStyle",
                              "value": "bars"
                           },
                           {
                              "id": "custom.lineWidth",
                              "value": 2
                           }
                        ]
                     },
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "chunks removed"
                        },
                        "properties": [
                           {
                              "id": "custom.axisPlacement",
                              "value": "right"
                           },
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "dark-red",
                                 "mode": "fixed"
                              }
                           },
                           {
                              "id": "custom.drawStyle",
                              "value": "bars"
                           },
                           {
                              "id": "custom.lineWidth",
                              "value": 2
                           }
                        ]
                     }
                  ]
               },
               "gridPos": {
                  "h": 8,
                  "w": 12,
                  "x": 12,
                  "y": 18
               },
               "id": 18,
               "options": { },
               "targets": [
                  {
                     "expr": "increase(prometheus_tsdb_head_chunks_created_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "chunks created"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_head_chunks_removed_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "chunks removed"
                  },
                  {
                     "expr": "prometheus_tsdb_head_chunks{job=\"$job\"}",
                     "legendFormat": "chunks total"
                  }
               ],
               "title": "Chunks (head block)",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "super-light-purple",
                        "mode": "fixed"
                     },
                     "custom": {
                        "drawStyle": "bars",
                        "lineWidth": 2
                     },
                     "min": 0,
                     "unit": "s"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 0,
                  "y": 26
               },
               "id": 19,
               "options": {
                  "legend": {
                     "displayMode": "hidden"
                  }
               },
               "targets": [
                  {
                     "expr": "rate(prometheus_tsdb_head_gc_duration_seconds_sum{job=\"$job\"}[$__rate_interval]) /\nrate(prometheus_tsdb_head_gc_duration_seconds_count{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "gc duration"
                  }
               ],
               "title": "GC duration (head block) (avg)",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "light-purple",
                        "mode": "fixed"
                     },
                     "custom": {
                        "drawStyle": "bars",
                        "lineWidth": 2
                     },
                     "min": 0,
                     "unit": "s"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 8,
                  "y": 26
               },
               "id": 20,
               "options": {
                  "legend": {
                     "displayMode": "hidden"
                  }
               },
               "targets": [
                  {
                     "expr": "rate(prometheus_tsdb_compaction_duration_seconds_sum{job=\"$job\"}[$__rate_interval]) /\nrate(prometheus_tsdb_compaction_duration_seconds_count{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "compaction duration"
                  }
               ],
               "title": "Compaction duration (avg)",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "light-purple",
                        "mode": "fixed"
                     },
                     "custom": {
                        "drawStyle": "bars",
                        "lineWidth": 2
                     },
                     "min": 0,
                     "unit": "s"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 16,
                  "y": 26
               },
               "id": 21,
               "options": {
                  "legend": {
                     "displayMode": "hidden"
                  }
               },
               "targets": [
                  {
                     "expr": "rate(prometheus_tsdb_wal_fsync_duration_seconds_sum{job=\"$job\"}[$__rate_interval]) /\nrate(prometheus_tsdb_wal_fsync_duration_seconds_count{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "fsync duration"
                  }
               ],
               "title": "WAL fsync duration (avg)",
               "type": "timeseries"
            }
         ],
         "repeat": null,
         "repeatIteration": null,
         "repeatRowId": null,
         "showTitle": true,
         "title": "TSDB",
         "titleSize": "h6",
         "type": "row"
      },
      {
         "collapse": true,
         "collapsed": true,
         "gridPos": {
            "X": 0,
            "h": 1,
            "w": 24,
            "y": 10
         },
         "id": 22,
         "panels": [
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "#6262ce",
                        "mode": "fixed"
                     },
                     "custom": {
                        "fillOpacity": 6
                     },
                     "min": 0,
                     "unit": "short"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 12,
                  "x": 0,
                  "y": 11
               },
               "id": 23,
               "options": {
                  "legend": {
                     "displayMode": "hidden"
                  }
               },
               "targets": [
                  {
                     "expr": "rate(prometheus_target_interval_length_seconds_count{job=\"$job\"}[$__rate_interval]) * 60",
                     "legendFormat": "scrapes/min"
                  }
               ],
               "title": "Scrapes / minute",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "continuous-YlBl",
                        "seriesBy": "last"
                     },
                     "custom": {
                        "fillOpacity": 6
                     },
                     "decimals": 2,
                     "unit": "s"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 12,
                  "x": 12,
                  "y": 11
               },
               "id": 24,
               "options": { },
               "targets": [
                  {
                     "expr": "prometheus_target_interval_length_seconds{job=\"$job\", quantile=\"0.9\"}",
                     "legendFormat": "q0.9 ({{ interval }} int)"
                  },
                  {
                     "expr": "prometheus_target_interval_length_seconds{job=\"$job\", quantile=\"0.99\"}",
                     "legendFormat": "q0.99 ({{ interval }} int)"
                  }
               ],
               "title": "Scrape intervals",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "description": "Which job produces the biggest number of samples.\n\nIf a job has multiple instances, only one is displayed, the one with biggest number (by using `max by (job)`.",
               "fieldConfig": { },
               "gridPos": {
                  "h": 8,
                  "w": 6,
                  "x": 0,
                  "y": 19
               },
               "id": 25,
               "options": {
                  "sortBy": [
                     {
                        "desc": true,
                        "displayName": "Value"
                     }
                  ]
               },
               "targets": [
                  {
                     "expr": "topk(5,\n  max by (job) (scrape_samples_scraped)\n)",
                     "format": "table",
                     "instant": true
                  }
               ],
               "title": "Most samples top5",
               "transformations": [
                  {
                     "id": "organize",
                     "options": {
                        "excludeByName": {
                           "Time": true
                        }
                     }
                  }
               ],
               "type": "table"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "description": "Which job took the longest.\n\nThe value is calculated as average of all the values from the last 1h (by using `avg_over_time[1h]`)\n\nIf a job has multiple instances, only one is displayed, the one with longest scrape (by using `max by (job)`.",
               "fieldConfig": {
                  "defaults": {
                     "unit": "s"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 6,
                  "x": 6,
                  "y": 19
               },
               "id": 26,
               "options": {
                  "sortBy": [
                     {
                        "desc": true,
                        "displayName": "scrape duration"
                     }
                  ]
               },
               "targets": [
                  {
                     "expr": "topk(5,\n  max by (job) (avg_over_time(scrape_duration_seconds[1h]))\n)",
                     "format": "table",
                     "instant": true
                  }
               ],
               "title": "Longest scrapes top5",
               "transformations": [
                  {
                     "id": "organize",
                     "options": {
                        "excludeByName": {
                           "Time": true
                        },
                        "renameByName": {
                           "Value": "scrape duration"
                        }
                     }
                  }
               ],
               "type": "table"
            },
            {
               "content": "# good to know\n- metric = a single \"word\" without any labels (dimension) attached to it\n- series = metric + uniq labels (hence, a single metric can have hundred of series)\n- sample = series + timestamp + value\n\n# handy queries\n- top 10 metrics with the biggest number of series\n    ```\n    topk(10, count by (__name__) ({__name__=~\".+\"}))\n    ```\n- top 10 jobs with the biggest number of series\n    ```\n    topk(10, sum by (job) (scrape_samples_scraped))\n    ```",
               "datasource": null,
               "gridPos": {
                  "h": 8,
                  "w": 12,
                  "x": 12,
                  "y": 19
               },
               "id": 27,
               "mode": "markdown",
               "title": "",
               "transparent": true,
               "type": "text"
            }
         ],
         "repeat": null,
         "repeatIteration": null,
         "repeatRowId": null,
         "showTitle": true,
         "title": "Scraping",
         "titleSize": "h6",
         "type": "row"
      },
      {
         "collapse": true,
         "collapsed": true,
         "gridPos": {
            "X": 0,
            "h": 1,
            "w": 24,
            "y": 11
         },
         "id": 28,
         "panels": [
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "palette-classic"
                     },
                     "custom": {
                        "fillOpacity": 10
                     }
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 0,
                  "y": 12
               },
               "id": 29,
               "options": { },
               "targets": [
                  {
                     "expr": "rate(prometheus_engine_query_duration_seconds_count{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "{{ slice }}"
                  }
               ],
               "title": "Engine query: queries / s",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "palette-classic"
                     },
                     "unit": "s"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 8,
                  "y": 12
               },
               "id": 30,
               "options": { },
               "targets": [
                  {
                     "expr": "# avg = sum / count\n\nrate(prometheus_engine_query_duration_seconds_sum{job=\"$job\"}[$__rate_interval]) /\nrate(prometheus_engine_query_duration_seconds_count{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "{{ slice }} (avg)"
                  },
                  {
                     "expr": "prometheus_engine_query_duration_seconds{job=\"$job\", quantile=\"0.9\"}",
                     "legendFormat": "{{ slice }} (q0.9)"
                  }
               ],
               "title": "Engine query: queries duration",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "fixed"
                     },
                     "custom": {
                        "fillOpacity": 12
                     }
                  },
                  "overrides": [
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "limit"
                        },
                        "properties": [
                           {
                              "id": "custom.fillOpacity",
                              "value": 0
                           },
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "light-red",
                                 "mode": "fixed"
                              }
                           }
                        ]
                     }
                  ]
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 16,
                  "y": 12
               },
               "id": 31,
               "options": { },
               "targets": [
                  {
                     "expr": "prometheus_engine_queries{job=\"$job\"}",
                     "legendFormat": "active queries"
                  },
                  {
                     "expr": "prometheus_engine_queries_concurrent_max{job=\"$job\"}",
                     "legendFormat": "limit"
                  }
               ],
               "title": "Engine query: active queries",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "description": "Edit or explore this panel to see requests rate per handler.",
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "continuous-BlYlRd"
                     },
                     "custom": {
                        "fillOpacity": 6
                     }
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 0,
                  "y": 20
               },
               "id": 32,
               "options": { },
               "targets": [
                  {
                     "expr": "sum (rate(prometheus_http_request_duration_seconds_count{job=\"$job\"}[$__rate_interval]))",
                     "legendFormat": "total"
                  },
                  {
                     "expr": "sum (rate(prometheus_http_request_duration_seconds_count{job=\"$job\", handler!=\"/metrics\"}[$__rate_interval]))",
                     "legendFormat": "total (w/o /metrics)"
                  },
                  {
                     "expr": "rate(prometheus_http_request_duration_seconds_count{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "{{ handler }}"
                  }
               ],
               "title": "Http: requests / s",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "description": "Edit or explore this panel to see requests rate per handler.",
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "continuous-YlRd"
                     },
                     "custom": {
                        "fillOpacity": 6
                     },
                     "unit": "s"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 8,
                  "y": 20
               },
               "id": 33,
               "options": { },
               "targets": [
                  {
                     "expr": "sum (rate(prometheus_http_request_duration_seconds_sum{job=\"$job\"}[$__rate_interval])) /\nsum (rate(prometheus_http_request_duration_seconds_count{job=\"$job\"}[$__rate_interval]))",
                     "legendFormat": "total"
                  },
                  {
                     "expr": "sum (rate(prometheus_http_request_duration_seconds_sum{job=\"$job\", handler!=\"/metrics\"}[$__rate_interval])) /\nsum (rate(prometheus_http_request_duration_seconds_count{job=\"$job\", handler!=\"/metrics\"}[$__rate_interval]))",
                     "legendFormat": "total (w/o /metrics)"
                  },
                  {
                     "expr": "rate(prometheus_http_request_duration_seconds_sum{job=\"$job\"}[$__rate_interval]) /\nrate(prometheus_http_request_duration_seconds_count{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "{{ handler }}"
                  }
               ],
               "title": "Http: requests duration (avg)",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "description": "Edit or explore this panel to see requests rate per handler.",
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "continuous-GrYlRd"
                     },
                     "custom": {
                        "fillOpacity": 6
                     },
                     "unit": "bytes"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 16,
                  "y": 20
               },
               "id": 34,
               "options": { },
               "targets": [
                  {
                     "expr": "sum(rate(prometheus_http_response_size_bytes_sum{job=\"$job\"}[$__rate_interval])) / \nsum(rate(prometheus_http_response_size_bytes_count{job=\"$job\"}[$__rate_interval]))",
                     "legendFormat": "total"
                  },
                  {
                     "expr": "sum(rate(prometheus_http_response_size_bytes_sum{job=\"$job\", handler!=\"/metrics\"}[$__rate_interval])) / \nsum(rate(prometheus_http_response_size_bytes_count{job=\"$job\", handler!=\"/metrics\"}[$__rate_interval]))",
                     "legendFormat": "total (w/o /metrics)"
                  },
                  {
                     "expr": "rate(prometheus_http_response_size_bytes_sum{job=\"$job\"}[$__rate_interval]) / \nrate(prometheus_http_response_size_bytes_count{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "{{ handler }}"
                  }
               ],
               "title": "Http: response size (avg)",
               "type": "timeseries"
            }
         ],
         "repeat": null,
         "repeatIteration": null,
         "repeatRowId": null,
         "showTitle": true,
         "title": "Query engine and HTTP",
         "titleSize": "h6",
         "type": "row"
      },
      {
         "collapse": true,
         "collapsed": true,
         "gridPos": {
            "X": 0,
            "h": 1,
            "w": 24,
            "y": 12
         },
         "id": 35,
         "panels": [
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "description": "Requests that returned 4** or 5**.",
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "light-red",
                        "mode": "fixed"
                     },
                     "custom": {
                        "drawStyle": "bars",
                        "fillOpacity": 6,
                        "lineWidth": 2
                     }
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 0,
                  "y": 13
               },
               "id": 36,
               "options": {
                  "legend": {
                     "displayMode": "hidden"
                  }
               },
               "targets": [
                  {
                     "expr": "sum(\n  increase(prometheus_http_requests_total{job=\"$job\", code!~\"2..|3..\"}[$__rate_interval])\n)",
                     "legendFormat": "total"
                  }
               ],
               "title": "Http failed requests",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "light-red",
                        "mode": "fixed"
                     },
                     "custom": {
                        "drawStyle": "bars",
                        "fillOpacity": 6,
                        "lineWidth": 2
                     }
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 8,
                  "y": 13
               },
               "id": 37,
               "options": { },
               "targets": [
                  {
                     "expr": "sum by (dialer_name) (increase(net_conntrack_dialer_conn_failed_total{job=\"$job\"}[$__rate_interval]))",
                     "legendFormat": "{{ dialer_name }}"
                  }
               ],
               "title": "Dialer connection errors",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "light-red",
                        "mode": "fixed"
                     },
                     "custom": {
                        "drawStyle": "bars",
                        "fillOpacity": 6,
                        "lineWidth": 2
                     }
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 16,
                  "y": 13
               },
               "id": 38,
               "options": { },
               "targets": [
                  {
                     "expr": "increase(prometheus_target_scrapes_exceeded_body_size_limit_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "exceeded_body_size_limit"
                  },
                  {
                     "expr": "increase(prometheus_target_scrapes_exceeded_sample_limit_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "exceeded_sample_limit"
                  },
                  {
                     "expr": "increase(prometheus_target_scrapes_exemplar_out_of_order_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "exemplar_out_of_order"
                  },
                  {
                     "expr": "increase(prometheus_target_scrapes_sample_duplicate_timestamp_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "sample_duplicate_timestamp"
                  },
                  {
                     "expr": "increase(prometheus_target_scrapes_sample_out_of_bounds_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "sample_out_of_bounds"
                  },
                  {
                     "expr": "increase(prometheus_target_scrapes_sample_out_of_order_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "sample_out_of_order"
                  }
               ],
               "title": "Scrape errors",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "light-red",
                        "mode": "fixed"
                     },
                     "custom": {
                        "drawStyle": "bars",
                        "fillOpacity": 6,
                        "lineWidth": 2
                     }
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 0,
                  "y": 21
               },
               "id": 39,
               "options": { },
               "targets": [
                  {
                     "expr": "increase(prometheus_target_scrape_pool_exceeded_label_limits_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "exceeded_label_limits"
                  },
                  {
                     "expr": "increase(prometheus_target_scrape_pool_exceeded_target_limit_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "exceeded_target_limit"
                  },
                  {
                     "expr": "increase(prometheus_target_scrape_pool_reloads_failed_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "reloads_failed"
                  },
                  {
                     "expr": "increase(prometheus_target_scrape_pools_failed_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "creation_failed"
                  }
               ],
               "title": "Scrape pools errors",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "light-red",
                        "mode": "fixed"
                     },
                     "custom": {
                        "drawStyle": "bars",
                        "fillOpacity": 6,
                        "lineWidth": 2
                     }
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 8,
                  "y": 21
               },
               "id": 40,
               "options": { },
               "targets": [
                  {
                     "expr": "increase(prometheus_sd_dns_lookup_failures_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "dns_lookup_failures"
                  },
                  {
                     "expr": "sum(prometheus_sd_failed_configs{job=\"$job\"})",
                     "legendFormat": "failed_configs"
                  },
                  {
                     "expr": "increase(prometheus_sd_file_read_errors_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "file_read_errors"
                  }
               ],
               "title": "Service discovery errors",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "light-red",
                        "mode": "fixed"
                     },
                     "custom": {
                        "drawStyle": "bars",
                        "fillOpacity": 6,
                        "lineWidth": 2
                     }
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 16,
                  "y": 21
               },
               "id": 41,
               "options": { },
               "targets": [
                  {
                     "expr": "increase(prometheus_tsdb_head_series_not_found_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "series_not_found"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_out_of_bound_samples_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "out_of_bound_samples"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_compactions_failed_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "compactions_failed"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_head_truncations_failed_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "head_truncations_failed"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_checkpoint_creations_failed_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "checkpoint_creations_failed"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_checkpoint_deletions_failed_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "checkpoint_deletions_failed"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_mmap_chunk_corruptions_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "mmap_chunk_corruptions"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_reloads_failures_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "reloads_failures"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_wal_corruptions_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "wal_corruptions"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_wal_truncations_failed_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "wal_truncations_failed"
                  },
                  {
                     "expr": "increase(prometheus_tsdb_wal_writes_failed_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "wal_writes_failed"
                  }
               ],
               "title": "TSDB errors",
               "type": "timeseries"
            }
         ],
         "repeat": null,
         "repeatIteration": null,
         "repeatRowId": null,
         "showTitle": true,
         "title": "Errors",
         "titleSize": "h6",
         "type": "row"
      },
      {
         "collapse": true,
         "collapsed": true,
         "gridPos": {
            "X": 0,
            "h": 1,
            "w": 24,
            "y": 13
         },
         "id": 42,
         "panels": [
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "semi-dark-purple",
                        "mode": "fixed"
                     },
                     "custom": {
                        "fillOpacity": 6
                     },
                     "min": 0,
                     "unit": "s"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 12,
                  "x": 0,
                  "y": 14
               },
               "id": 43,
               "options": {
                  "legend": {
                     "displayMode": "hidden"
                  }
               },
               "targets": [
                  {
                     "expr": "irate(process_cpu_seconds_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "cpu usage"
                  }
               ],
               "title": "CPU usage",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "continuous-BlPu"
                     },
                     "custom": {
                        "fillOpacity": 6
                     },
                     "min": 0,
                     "unit": "s"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 6,
                  "x": 12,
                  "y": 14
               },
               "id": 44,
               "options": { },
               "targets": [
                  {
                     "expr": "go_goroutines{job=\"$job\"}",
                     "legendFormat": "goroutines"
                  },
                  {
                     "expr": "go_threads{job=\"$job\"}",
                     "legendFormat": "threads"
                  }
               ],
               "title": "Goroutines and threads",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "continuous-BlPu"
                     },
                     "unit": "short"
                  },
                  "overrides": [
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "limit"
                        },
                        "properties": [
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "semi-dark-red",
                                 "mode": "fixed"
                              }
                           }
                        ]
                     }
                  ]
               },
               "gridPos": {
                  "h": 8,
                  "w": 6,
                  "x": 18,
                  "y": 14
               },
               "id": 45,
               "options": { },
               "targets": [
                  {
                     "expr": "process_open_fds{job=\"$job\"}",
                     "legendFormat": "open files"
                  },
                  {
                     "expr": "process_max_fds{job=\"$job\"}",
                     "legendFormat": "limit"
                  }
               ],
               "title": "Open files",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "#f43e58",
                        "mode": "fixed"
                     },
                     "custom": {
                        "fillOpacity": 6
                     },
                     "unit": "bytes"
                  },
                  "overrides": [
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "allocations"
                        },
                        "properties": [
                           {
                              "id": "unit",
                              "value": "binBps"
                           },
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "#9f851f",
                                 "mode": "fixed"
                              }
                           }
                        ]
                     }
                  ]
               },
               "gridPos": {
                  "h": 8,
                  "w": 12,
                  "x": 0,
                  "y": 22
               },
               "id": 46,
               "options": { },
               "targets": [
                  {
                     "expr": "process_resident_memory_bytes{job=\"$job\"}",
                     "legendFormat": "resident memory"
                  },
                  {
                     "expr": "process_virtual_memory_bytes{job=\"$job\"}",
                     "hide": true,
                     "legendFormat": "virtual memory"
                  },
                  {
                     "expr": "rate(go_memstats_alloc_bytes_total{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "allocations"
                  }
               ],
               "title": "Memory usage",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "super-light-yellow",
                        "mode": "fixed"
                     },
                     "custom": {
                        "fillOpacity": 6
                     },
                     "unit": "bytes"
                  },
                  "overrides": [
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "inuse"
                        },
                        "properties": [
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "semi-dark-red",
                                 "mode": "fixed"
                              }
                           }
                        ]
                     },
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "objects"
                        },
                        "properties": [
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "super-light-purple",
                                 "mode": "fixed"
                              }
                           },
                           {
                              "id": "unit",
                              "value": "short"
                           }
                        ]
                     }
                  ]
               },
               "gridPos": {
                  "h": 8,
                  "w": 6,
                  "x": 12,
                  "y": 22
               },
               "id": 47,
               "options": { },
               "targets": [
                  {
                     "expr": "go_memstats_heap_inuse_bytes{job=\"$job\"}",
                     "legendFormat": "inuse"
                  },
                  {
                     "expr": "go_memstats_heap_idle_bytes{job=\"$job\"}",
                     "legendFormat": "idle"
                  },
                  {
                     "expr": "go_memstats_heap_objects{job=\"$job\"}",
                     "legendFormat": "objects"
                  }
               ],
               "title": "Heap",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "fixedColor": "dark-yellow",
                        "mode": "fixed"
                     },
                     "custom": {
                        "fillOpacity": 6
                     },
                     "unit": "s"
                  },
                  "overrides": [
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "GC time (q=0.75)"
                        },
                        "properties": [
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "light-yellow",
                                 "mode": "fixed"
                              }
                           }
                        ]
                     },
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "GC time (q=1)"
                        },
                        "properties": [
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "super-light-yellow",
                                 "mode": "fixed"
                              }
                           }
                        ]
                     },
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "GCs / minute"
                        },
                        "properties": [
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "dark-red",
                                 "mode": "fixed"
                              }
                           },
                           {
                              "id": "unit",
                              "value": "none"
                           }
                        ]
                     }
                  ]
               },
               "gridPos": {
                  "h": 8,
                  "w": 6,
                  "x": 18,
                  "y": 22
               },
               "id": 48,
               "options": { },
               "targets": [
                  {
                     "expr": "rate(go_gc_duration_seconds_count{job=\"$job\"}[$__rate_interval]) * 60",
                     "legendFormat": "GCs / minute"
                  },
                  {
                     "expr": "# avg = sum / caount\nrate(go_gc_duration_seconds_sum{job=\"$job\"}[$__rate_interval]) /\nrate(go_gc_duration_seconds_count{job=\"$job\"}[$__rate_interval])",
                     "legendFormat": "GC time (avg)"
                  },
                  {
                     "expr": "go_gc_duration_seconds{job=\"$job\", quantile=\"0.75\"}",
                     "legendFormat": "GC time (q=0.75)"
                  },
                  {
                     "expr": "go_gc_duration_seconds{job=\"$job\", quantile=\"1\"}",
                     "legendFormat": "GC time (q=1)"
                  }
               ],
               "title": "Garbage collection",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "palette-classic"
                     },
                     "custom": {
                        "fillOpacity": 6
                     }
                  },
                  "overrides": [
                     {
                        "matcher": {
                           "id": "byName",
                           "options": "samples scraped"
                        },
                        "properties": [
                           {
                              "id": "color",
                              "value": {
                                 "fixedColor": "semi-dark-blue",
                                 "mode": "fixed"
                              }
                           }
                        ]
                     }
                  ]
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 0,
                  "y": 30
               },
               "id": 49,
               "options": { },
               "targets": [
                  {
                     "expr": "scrape_samples_scraped{job=\"$job\"}",
                     "legendFormat": "samples scraped"
                  },
                  {
                     "expr": "scrape_series_added{job=\"$job\"}",
                     "legendFormat": "series added"
                  }
               ],
               "title": "Self scraping: samples",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "continuous-BlPu"
                     },
                     "custom": {
                        "fillOpacity": 6
                     },
                     "unit": "s"
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 8,
                  "y": 30
               },
               "id": 50,
               "options": { },
               "targets": [
                  {
                     "expr": "scrape_duration_seconds{job=\"$job\"}",
                     "legendFormat": "scrape duration"
                  }
               ],
               "title": "Self scraping: duration",
               "type": "timeseries"
            },
            {
               "datasource": {
                  "type": "prometheus",
                  "uid": "${PROMETHEUS_DS}"
               },
               "fieldConfig": {
                  "defaults": {
                     "color": {
                        "mode": "continuous-blues"
                     },
                     "custom": {
                        "fillOpacity": 6
                     }
                  }
               },
               "gridPos": {
                  "h": 8,
                  "w": 8,
                  "x": 16,
                  "y": 30
               },
               "id": 51,
               "options": { },
               "targets": [
                  {
                     "expr": "rate(promhttp_metric_handler_requests_total{job=\"$job\"}[$__rate_interval]) * 60",
                     "legendFormat": "{{ code }}"
                  }
               ],
               "title": "Self scraping: http responses / minute",
               "type": "timeseries"
            }
         ],
         "repeat": null,
         "repeatIteration": null,
         "repeatRowId": null,
         "showTitle": true,
         "title": "Prometheus internals (process and self scrape info)",
         "titleSize": "h6",
         "type": "row"
      },
      {
         "collapse": true,
         "collapsed": true,
         "gridPos": {
            "X": 0,
            "h": 1,
            "w": 24,
            "y": 14
         },
         "id": 52,
         "panels": [
            {
               "datasource": {
                  "type": "loki",
                  "uid": "${LOKI_DS}"
               },
               "gridPos": {
                  "h": 14,
                  "w": 24,
                  "x": 0,
                  "y": 15
               },
               "id": 53,
               "options": { },
               "targets": [
                  {
                     "expr": "{app=\"${job}\"}"
                  }
               ],
               "title": "",
               "type": "logs"
            }
         ],
         "repeat": null,
         "repeatIteration": null,
         "repeatRowId": null,
         "showTitle": true,
         "title": "Prometheus logs",
         "titleSize": "h6",
         "type": "row"
      }
   ],
   "refresh": "",
   "rows": [ ],
   "schemaVersion": 14,
   "style": "dark",
   "tags": [ ],
   "templating": {
      "list": [
         {
            "current": {
               "text": "prometheus",
               "value": "prometheus"
            },
            "hide": 2,
            "label": null,
            "name": "PROMETHEUS_DS",
            "options": [ ],
            "query": "prometheus",
            "refresh": 1,
            "regex": "",
            "type": "datasource"
         },
         {
            "current": {
               "text": "loki",
               "value": "loki"
            },
            "hide": 2,
            "label": null,
            "name": "LOKI_DS",
            "options": [ ],
            "query": "loki",
            "refresh": 1,
            "regex": "",
            "type": "datasource"
         },
         {
            "allValue": null,
            "current": {
               "text": "prometheus",
               "value": "prometheus"
            },
            "hide": 2,
            "includeAll": false,
            "label": "",
            "multi": false,
            "name": "job",
            "options": [
               {
                  "text": "prometheus",
                  "value": "prometheus"
               }
            ],
            "query": "prometheus",
            "refresh": 0,
            "type": "custom"
         }
      ]
   },
   "time": {
      "from": "now-1h",
      "to": "now"
   },
   "timepicker": {
      "refresh_intervals": [
         "5s",
         "10s",
         "30s",
         "1m",
         "5m",
         "15m",
         "30m",
         "1h",
         "2h",
         "1d"
      ],
      "time_options": [
         "5m",
         "15m",
         "1h",
         "6h",
         "12h",
         "24h",
         "2d",
         "7d",
         "30d"
      ]
   },
   "timezone": "utc",
   "title": "Prometheus",
   "version": 0
}
